        <%= truncate(discount.title.text_gilensize, :length => 45) %>
        <%= path_for_email(discount) %>
        <%= discount.title.text_gilensize %>
        <%= discount.title.text_gilensize %>
        <%= path_for_email(discount) %>
        <% unless discount.is_a?(AffiliatedCoupon) %>

          <% if discount.is_a?(OfferedDiscount) %>
            <%= path_for_email(discount, :offer_price) %>
          <% else %>
            <% if discount.price.nil? || discount.price.zero? %>
              <%= path_for_email(discount, :buy_ticket) %>
            <% else %>
              <%= path_for_email(discount, :buy_ticket) %>
            <% end %>
          <% end %>

        <% else %>

          <% if discount.price.nil? || discount.price.zero? %>
            <% #NOTICE this is for pricupon %>
            <%= discount.supplier.try(:link) %>
        <% else %>
          <% #NOTICE this is for pricupon %>
          <%= discount.supplier.try(:link) %>
      <% end %>

    <% end %>
    <% if discount.places.empty? %>
      <%= "&nbsp;".html_safe %>
    <% else %>
      <% place = discount.places.first %>
      <% if place.organization_id? %>
        <%= truncate(place.organization.try(:title), :length => 30) %>
        <%= path_for_email(place.organization) %>
        <%= place.address %>
      <% else %>
        <%= truncate(place.address, :length => 30) %>
      <% end %>
    <% end %>
    <%= render :partial => "site_digest_mailer/#{discount.class.name.underscore}_info", :locals => { :discount=> discount} %>
